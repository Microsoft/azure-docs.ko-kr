---
title: 'Azure AD Connect: 한 포리스트에서 다른 포리스트로 그룹 마이그레이션'
description: 이 문서에서는 Azure AD Connect의 한 포리스트에서 다른 포리스트로 그룹을 마이그레이션하는 데 필요한 단계를 설명합니다.
services: active-directory
author: billmath
manager: daveba
ms.service: active-directory
ms.topic: how-to
ms.workload: identity
ms.date: 04/02/2020
ms.subservice: hybrid
ms.author: billmath
ms.collection: M365-identity-device-management
ms.openlocfilehash: 5ef693a48dc52854e4e1fd8359ef24f65ce236f7
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/29/2021
ms.locfileid: "85358585"
---
# <a name="migrate-groups-from-one-forest-to-another-for-azure-ad-connect"></a>Azure AD Connect의 한 포리스트에서 다른 포리스트로 그룹 마이그레이션

이 문서에서는 마이그레이션된 그룹 개체가 클라우드의 기존 개체와 일치하도록 한 포리스트에서 다른 포리스트로 그룹을 마이그레이션하는 방법을 설명합니다.

## <a name="prerequisites"></a>필수 구성 요소

- Azure AD Connect 버전 1.5.18.0 이상
- `mS-DS-ConsistencyGuid`로 설정된 원본 앵커 특성

## <a name="migrate-groups"></a>그룹 마이그레이션

버전 1.5.18.0부터 Azure AD Connect는 그룹의 `mS-DS-ConsistencyGuid` 특성 사용을 지원합니다. `mS-DS-ConsistencyGuid`를 원본 앵커 특성으로 선택하고 Active Directory에서 값이 채워지면 Azure AD Connect는 `mS-DS-ConsistencyGuid` 값을 `immutableId`로 사용합니다. 그렇지 않으면 `objectGUID`를 대신 사용합니다. 하지만 Azure AD Connect는 Active Directory의 `mS-DS-ConsistencyGuid` 특성에 값을 다시 쓰지 않습니다.

포리스트 간 이동 중 그룹 개체가 한 포리스트(예: F1)에서 다른 포리스트(예: F2)로 이동하는 경우 포리스트 F1에 있는 개체의 `mS-DS-ConsistencyGuid` 값(있는 경우) 또는 `objectGUID` 값을 F2에 있는 개체의 `mS-DS-ConsistencyGuid` 특성에 복사해야 합니다.

다음 스크립트를 지침으로 사용하여 한 포리스트에서 다른 포리스트로 단일 그룹을 마이그레이션하는 방법을 알아봅니다. 해당 스크립트를 여러 그룹의 마이그레이션을 위한 지침으로 사용할 수도 있습니다. 스크립트에서는 포리스트 이름 F1은 원본 포리스트로, F2는 대상 포리스트로 사용합니다.

먼저 포리스트 F1의 그룹 개체 `objectGUID` 및 `mS-DS-ConsistencyGuid`를 가져옵니다. 해당 특성은 CSV 파일로 내보냅니다.
```
<#
DESCRIPTION
============
This script will take DN of a group as input.
It then copies the objectGUID and mS-DS-ConsistencyGuid values along with other attributes of the given group to a CSV file.

This CSV file can then be used as input to the Export-Group script.
#>
Param(
       [ValidateNotNullOrEmpty()]
       [string]
       $dn,

       [ValidateNotNullOrEmpty()]
       [string]
       $outputCsv
)

$defaultProperties = @('samAccountName', 'distinguishedName', 'objectGUID', 'mS-DS-ConsistencyGuid')
$group  = Get-ADGroup -Filter "DistinguishedName -eq '$dn'" -Properties $defaultProperties -ErrorAction Stop
$results = @()
if ($group -eq $null)
{
       Write-Error "Group not found"
}
else
{
       $objectGUIDValue = [GUID]$group.'objectGUID'
       $mSDSConsistencyGuidValue = "N/A"
       if ($group.'mS-DS-ConsistencyGuid' -ne $null)
       {
              $mSDSConsistencyGuidValue = [GUID]$group.'mS-DS-ConsistencyGuid'
       }
       $adgroup = New-Object -TypeName PSObject
       $adgroup | Add-Member -MemberType NoteProperty -Name samAccountName -Value $($group.'samAccountName')
       $adgroup | Add-Member -MemberType NoteProperty -Name distinguishedName -Value $($group.'distinguishedName')
       $adgroup | Add-Member -MemberType NoteProperty -Name objectGUID -Value $($objectGUIDValue)
       $adgroup | Add-Member -MemberType NoteProperty -Name mS-DS-ConsistencyGuid -Value $($mSDSConsistencyGuidValue)
       $results += $adgroup
}

Write-Host "Exporting group to output file"
$results | Export-Csv "$outputCsv" -NoTypeInformation

```

그런 다음, 생성된 출력 CSV 파일을 사용하여 포리스트 F2의 대상 개체에 대한 `mS-DS-ConsistencyGuid` 특성에 스탬프를 지정합니다.


```
<#
DESCRIPTION
============
This script will take DN of a group as input and the CSV file that was generated by the Import-Group script.
It copies either the objectGUID or the mS-DS-ConsistencyGuid value from the CSV file to the given object.

#>
Param(
       [ValidateNotNullOrEmpty()]
       [string]
       $dn,

       [ValidateNotNullOrEmpty()]
       [string]
       $inputCsv
)

$group  = Get-ADGroup -Filter "DistinguishedName -eq '$dn'" -ErrorAction Stop
if ($group -eq $null)
{
       Write-Error "Group not found"
}

$csvFile = Import-Csv -Path $inputCsv -ErrorAction Stop
$msDSConsistencyGuid = $csvFile.'mS-DS-ConsistencyGuid'
$objectGuid = [GUID] $csvFile.'objectGUID'
$targetGuid = $msDSConsistencyGuid

if ($msDSConsistencyGuid -eq "N/A")
{
       $targetGuid = $objectGuid
}

Set-ADGroup -Identity $dn -Replace @{'mS-DS-ConsistencyGuid'=$targetGuid} -ErrorAction Stop

```

## <a name="next-steps"></a>다음 단계
[Azure Active Directory와 온-프레미스 ID 통합](whatis-hybrid-identity.md)에 대해 자세히 알아봅니다.
