---
title: Azure Cosmos DB에서 가상 파티션 키를 만들어 데이터와 워크로드를 균등하게 분산시키는 방법을 설명합니다.
description: Azure Cosmos 컨테이너에 가상 파티션 키를 사용하는 방법에 대한 자세한 정보
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 03/31/2019
ms.author: rimman
ms.openlocfilehash: 6b3499c36ae7abd03c4a1f1ca3a3a46e2c315120
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/23/2019
ms.locfileid: "60937103"
---
# <a name="create-a-synthetic-partition-key"></a>가상 파티션 키 만들기

수백 또는 수천 대 등 많은 고유 값을 가진 파티션 키가는 것이 좋습니다. 이러한 파티션 키 값과 연결된 항목에 데이터 및 워크로드를 균등하게 배포하는 것이 목표입니다. 이러한 속성은 데이터에 존재 하지 않으면를 생성할 수 있습니다는 *가상 파티션 키*합니다. 이 문서에서는 Cosmos 컨테이너에 대 한 가상 파티션 키를 생성 하는 몇 가지 기본적인 기술을 설명 합니다.

## <a name="concatenate-multiple-properties-of-an-item"></a>항목의 여러 속성 연결

여러 속성 값을 인위적인 `partitionKey` 속성 하나에 연결하여 파티션 키를 구성할 수 있습니다. 이러한 키는 가상 키로 참조됩니다. 예를 들어 다음 예제 문서를 살펴보겠습니다.

```JavaScript
{
"deviceId": "abc-123",
"date": 2018
}
```

이전 문서의 경우 한 가지 옵션은 /deviceId 또는 /date를 파티션 키로 설정하는 것입니다. 장치 ID 또는 날짜에 따라 컨테이너를 분할 하려는 경우이 옵션을 사용 합니다. 또 다른 옵션은 이러한 두 값을 파티션 키로 사용되는 가상 `partitionKey` 속성으로 연결하는 것입니다.

```JavaScript
{
"deviceId": "abc-123",
"date": 2018,
"partitionKey": "abc-123-2018"
}
```

실시간 시나리오에서 수천 개의 데이터베이스에 항목이 있습니다. 가상 키를 수동으로 추가 하는 대신 값을 연결 하 고 Cosmos 컨테이너에 있는 항목의 가상 키 삽입에 대 한 클라이언트 쪽 논리를 정의 합니다.

## <a name="use-a-partition-key-with-a-random-suffix"></a>임의의 접미사가 붙는 파티션 키 사용

워크로드를 보다 균등하게 분산할 수 있는 또 다른 전략은 파티션 키 값의 끝에 임의의 숫자를 추가하는 것입니다. 이러한 방식으로 항목을 분산하면 여러 파티션에서 병렬 쓰기 작업을 수행할 수 있습니다.

파티션 키가 날짜를 나타내는 경우를 예로 들 수 있습니다. 1과 400 사이의 난수를 선택 하 고 날짜를 접미사로 연결 될 수 있습니다. 이 메서드는 같은 파티션 키 값의 결과 `2018-08-09.1`,`2018-08-09.2`등을 통해 `2018-08-09.400`합니다. 파티션 키를 무작위로 지정하므로 매일 수행되는 컨테이너의 쓰기 작업이 여러 파티션에 균등하게 분배됩니다. 이 방법을 사용하면 병렬 처리 성능이 향상되고 전체적인 처리량이 많아집니다.

## <a name="use-a-partition-key-with-pre-calculated-suffixes"></a>미리 계산 된 접미사를 사용 하 여 파티션 키를 사용 합니다. 

임의 접미사 전략 쓰기 처리량을 크게 높일 수 있지만 특정 항목을 읽는 것이 어렵습니다. 항목을 작성할 때 사용 된 접미사 값을 알 수 없습니다. 개별 항목을 읽기 쉽게 미리 계산 된 접미사 전략을 사용 합니다. 난수를 사용 하 여 파티션 간에 항목을 배포를 대신 쿼리 하려는 항목을 기반으로 계산 되는 숫자를 사용 합니다.

컨테이너를 파티션 키로 날짜를 사용 하는 이전 예제를 살펴보겠습니다. 이제 각 항목에 있는지를 가정를 `Vehicle-Identification-Number` (`VIN`)에 액세스 하려고 하는 특성입니다. 또한 항목을 찾는 쿼리를 자주 실행 하는 경우는 `VIN`, 날짜 외에도 합니다. 애플리케이션은 컨테이너에 항목을 쓰기 전에 VIN을 기반으로 해시 접미사를 계산하여 파티션 키 날짜에 추가할 수 있습니다. 계산 균등 하 게 분산 되는 1 ~ 400 사이의 숫자를 생성할 수 있습니다. 이 결과 임의의 접미사 전략 메서드에 의해 생성 되는 결과 비슷합니다. 날짜에 계산 결과를 연결한 값이 파티션 키 값이 됩니다.

이 전략을 사용하면 쓰기가 파티션 키 값 및 파티션 간에 균등하게 분산됩니다. 쉽게 읽을 수는 특정 항목 및 날짜를 특정 파티션 키 값을 계산할 수 없기 때문 `Vehicle-Identification-Number`합니다. 이 방법의 장점은 모든 워크 로드를 사용 하는 파티션 키, 즉 단일 핫 파티션 키를 만들지 않으려면 수 있습니다. 

## <a name="next-steps"></a>다음 단계

다음 문서에서 분할이라는 개념에 대해 좀 더 자세히 알아볼 수 있습니다.

* [논리 파티션](partition-data.md)에 대해 자세히 알아봅니다.
* [Azure Cosmos 컨테이너 및 데이터베이스에 대한 처리량을 프로비전](set-throughput.md)하는 방법을 자세히 알아봅니다.
* [Azure Cosmos 컨테이너의 처리량을 프로비전](how-to-provision-container-throughput.md)하는 방법을 알아봅니다.
* [Azure Cosmos 데이터베이스의 처리량을 프로비전](how-to-provision-database-throughput.md)하는 방법을 알아봅니다.
