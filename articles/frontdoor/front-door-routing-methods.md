---
title: Azure Front Door Service - 트래픽 라우팅 메서드 | Microsoft Docs
description: 이 문서는 Front Door에서 사용하는 다양한 트래픽 라우팅 방법을 이해하는 데 도움이 됩니다.
services: front-door
documentationcenter: ''
author: sharad4u
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/10/2018
ms.author: sharadag
ms.openlocfilehash: bd1278db43ba31ed78f13a826a330e16c3bc8d57
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/23/2019
ms.locfileid: "60736227"
---
# <a name="front-door-routing-methods"></a>Front Door 라우팅 메서드

Azure Front Door Service는 다양한 서비스 엔드포인트에 HTTP/HTTPS 트래픽을 라우팅하는 방법을 결정하는 다양한 트래픽 라우팅 방법을 지원합니다. Front Door에 도달하는 각 클라이언트 요청을 통해, 구성된 라우팅 메서드는 요청이 최상의 백 엔드 인스턴스에 전달되도록 적용됩니다. 

Front Door에서 사용 가능한 트래픽 라우팅에 대한 4가지 주요 개념이 있습니다.

* **[대기 시간](#latency):** 대기 시간 기반 라우팅은 요청이 민감도 범위 내에서 허용 가능한 최저 대기 시간 백 엔드로 전송되도록 해줍니다. 기본적으로, 사용자 요청은 네트워크 대기 시간에 관하여 “가장 가까운” 백 엔드 집합으로 전송됩니다.
* **[우선 순위](#priority):** 모든 트래픽에 대해 기본 서비스 백 엔드를 사용하고 기본 또는 백업 엔드포인트를 사용할 수 없을 때 백업을 제공하려면 여러 다른 백 엔드에 우선 순위를 할당할 수 있습니다.
* **[가중](#weighted):** 백 엔드 집합에서 균일하게 또는 가중 계수에 따라 트래픽을 분산하려는 경우 백 엔드마다 가중치를 할당할 수 있습니다.
* **세션 선호도:** 사용자 세션이 여전히 활성 상태이고 백 엔드 인스턴스가 상태 프로브에 기반하여 상태를 양호하게 보고하는 한 사용자의 후속 요청이 동일한 백 엔드로 전송되기를 원할 때 프론트 엔드 호스트 또는 도메인에 대한 세션 선호도를 구성할 수 있습니다. 

모든 Front Door 구성에는 백 엔드 상태 및 자동화된 인스턴트 글로벌 장애 조치(failover)의 모니터링이 포함됩니다. 자세한 내용은 [Front Door 백 엔드 모니터링](front-door-health-probes.md)을 참조하세요. Front Door는 단일 라우팅 메서드에 기반한 작업으로 구성하고 사용자의 애플리케이션 요구 사항에 따라 여러 또는 이러한 모든 라우팅 메서드를 조합하여 사용하여 최적의 라우팅 토폴로지를 빌드할 수 있습니다.

## <a name = "latency"></a>최저 대기 시간 기반 트래픽 라우팅

전 세계적으로 둘 이상의 위치에 백 엔드를 배포하면 트래픽을 최종 사용자에게 '가장 가까운' 위치로 라우팅하여 많은 애플리케이션의 응답성을 향상시킬 수 있습니다. Front Door 구성에 대한 기본 트래픽 라우팅 메서드는 최종 사용자의 요청을 해당 요청을 수신한 Front Door 환경에서 가장 가까운 백 엔드로 전달합니다. Azure Front Door Service의 Anycast 아키텍처와 결합한 이 접근 방식은 각 최종 사용자가 해당 위치에 기반하여 개인 설정된 최대 성능을 얻을 수 있도록 보장합니다.

'가장 가까운' 백 엔드가 반드시 지리적 거리를 기준으로 가장 가깝게 지정되는 것은 아닙니다. 대신, Front Door는 네트워크 대기 시간을 측정하여 가장 가까운 백 엔드를 결정합니다. [Front Door의 라우팅 아키텍처](front-door-routing-architecture.md)에 대해 자세히 알아보세요. 

다음은 전체 의사 결정 흐름입니다.

| 사용할 수 있는 백 엔드 | 우선 순위 | 대기 시간 신호(상태 프로브 기반) | Weights |
|-------------| ----------- | ----------- | ----------- |
| 먼저, 상태 브로브에 대해 활성화되어 양호한 것으로 보고된(200 OK) 모든 백 엔드를 선택합니다. 예를 들어, 6개의 백 엔드 A, B, C, D, E 및 F가 있으며 이들 중 C는 상태가 양호하지 않고 E는 비활성화되어 있습니다. 따라서 사용 가능한 백 엔드 목록은 A, B, D 및 F입니다.  | 다음으로, 사용 가능한 것 중 우선 순위가 가장 높은 백 엔드가 선택됩니다. 예를 들어, 백 엔드 A, B 및 D의 우선 순위는 1이며, 백 엔드 F의 우선 순위는 2입니다. 따라서 선택된 백 엔드는 A, B 및 D가 됩니다.| 대기 시간 범위로 백 엔드를 선택합니다(최저 대기 시간 및 지정된 ms에서 대기 시간 민감도). 예를 들어, 요청이 도착한 Front Door 환경에서 A가 15ms, B가 30ms 및 D가 60ms 거리에 있고 대기 시간 감도가 30ms인 경우 D가 가장 가까운 백 엔드인 A와 30ms 이상 거리에 있으므로, 최저 대기 시간 풀은 백 엔드 A와 B로 구성됩니다. | 마지막으로, Front Door는 지정된 가중치 비율에서 최종 선택된 백 엔드 풀 중에서 트래픽을 라운드 로빈합니다. 예를 들어, 백 엔드 A의 가중치가 5이고 백 엔드 B의 가중치가 8인 경우 트래픽은 백 엔드 5와 8 사이에서 5:8 비율로 분산됩니다. |

>[!NOTE]
> 기본적으로, 대기 시간 민감도 속성은 0ms로 설정됩니다. 즉, 항상 요청을 사용 가능한 가장 빠른 백 엔드로 전달합니다.


## <a name = "priority"></a>우선 순위 기반 트래픽 라우팅

종종 조직에서는 기본 서비스가 중단될 경우에 하나 이상의 백업 서비스를 배포하여 해당 서비스에 대한 안정성을 제공합니다. 업계 전체에서 이 토폴로지는 활성/대기 또는 활성/수동 배포 토폴로지라고 하기도 합니다. '우선 순위' 트래픽 라우팅 메서드를 사용하여 Azure 고객은 이러한 장애 조치(Failover) 패턴을 쉽게 구현할 수 있습니다.

기본 Front Door에는 우선 순위가 동등한 백 엔드 목록이 포함되어 있습니다. 기본적으로, Front Door는 최고 우선 순위 백 엔드(최저 우선 순위 값), 즉 기본 백 엔드 집합으로만 트래픽을 전송합니다. 기본 백 엔드를 사용할 수 없는 경우 Front Door는 트래픽을 보조 백 엔드 집합(두 번째 낮은 우선 순위 값)으로 라우팅합니다. 기본 및 보조 백 엔드를 모두 사용할 수 없는 경우 트래픽이 세 번째 백 엔드 등으로 전송됩니다. 백 엔드의 가용성은 구성된 상태(활성 또는 비활성화)과 상태 프로브의 결정에 따른 지속적인 백 엔드 상태에 기반합니다.

### <a name="configuring-priority-for-backends"></a>백 엔드에 대한 우선 순위 구성

Front Door 구성 내 백 엔드 풀에 있는 각 백 엔드는 ‘우선 순위’라고 하는 속성이 있으며, 1에서 5 사이의 숫자가 될 수 있습니다. Azure Front Door Service를 통해, 각 백 엔드에 대해 이 속성을 사용하여 백 엔드 속성을 명시적으로 구성할 수 있습니다. 이 속성은 1에서 5 사이의 값입니다. 값이 낮을수록 더 높은 우선 순위를 나타냅니다. 백 엔드는 우선 순위 값을 공유할 수 있습니다.

## <a name = "weighted"></a>가중 트래픽 라우팅 방법
'가중' 트래픽 라우팅 메서드를 사용하면 균등하게 트래픽을 분산하거나 미리 정의된 가중치를 사용할 수 있습니다.

가중 트래픽 라우팅 메서드에서는 백 엔드 풀의 Front Door 구성에서 각 백 엔드에 가중치를 할당할 수 있습니다. 가중치는 1에서 1000 사이의 정수입니다. 이 매개 변수는 기본 가중치인 '50'을 사용합니다.

허용된 대기 시간 민감도(지정된 대로) 내에 사용 가능한 백 엔드 목록 가운데 이 트래픽은 지정된 가중치 비율로 라운드-로빈 메커니즘에서 분산됩니다. 대기 시간 민감도가 0ms로 설정되어 있는 경우 네트워크 대기 시간이 동일한 두 개의 백 엔드가 있지 않다면 이 속성은 적용되지 않습니다. 

가중 메서드를 사용하면 다음과 같은 몇 가지 유용한 시나리오를 사용할 수 있습니다.

* **점진적 애플리케이션 업그레이드**: 새로운 백 엔드로 라우팅할 트래픽의 백분율을 할당하고 시간 경과에 따라 점진적으로 트래픽을 다른 백 엔드와 같아질 때까지 늘립니다.
* **Azure에 애플리케이션 마이그레이션**: Azure 및 외부 백 엔드로 백 엔드 풀을 만듭니다. 새 백 엔드를 선호하도록 백 엔드의 가중치를 조정합니다. 새 백 엔드를 비활성화하는 것으로 시작하여 최저 가중치를 할당하고 대부분 트래픽을 처리하는 수준까지 서서히 늘려 점진적으로 설정할 수 있습니다. 마지막으로 선호도가 낮은 백 엔드를 비활성화한 후 풀에서 이들을 제거합니다.  
* **추가 용량을 위한 클라우드 버스트**: Front Door 뒤에 두고 온-프레미스 배포를 클라우드로 신속하게 확장합니다. 클라우드에서 추가 용량이 필요한 경우 더 많은 백 엔드를 추가 또는 활성화하고 각 백 엔드로 분산되는 트래픽 비율을 지정할 수 있습니다.

## <a name = "affinity"></a>세션 선호도
기본적으로, 세션 선호도가 없다면 특히 다른 백 엔드에 대한 대기 시간이 변하거나, 동일한 사용자의 다른 요청이 다른 Front Door 환경에 도착할 경우 Front Door는 같은 클라이언트에서 발생하는 요청을 부하 분산 구성에 기반하여 다른 백 엔드로 전달합니다. 그러나 일부 상태 저장 애플리케이션 또는 다른 특정 시나리오에서 동일한 사용자의 후속 요청이 초기 요청을 처리한 같은 백 엔드에 도착하는 것이 좋습니다. 쿠키 기반 세션 선호도 기능은 동일한 백 엔드에서 사용자 세션을 유지하려는 경우에 유용합니다. Azure Front Door Service는 Front Door 관리 쿠키를 사용하여 백 엔드의 상태가 양호하고 사용자 세션이 만료되지 않은 한 처리를 위해 사용자 세션의 후속 트래픽을 동일한 백 엔드로 연결할 수 있습니다. 

세션 선호도는 구성된 각 도메인(또는 하위 도메인)에 대해 프론트 엔드 호스트 레벨에서 활성화할 수 있습니다. 활성화되면 Front Door는 사용자 세션에 쿠키를 추가합니다. 쿠키 기반 세션 선호도를 통해 Front Door는 동일한 IP 주소를 사용하고 있더라도 다른 사용자를 식별할 수 있어 다른 백 엔드 간에 트래픽을 더 고르게 분산시킬 수 있습니다.

Front Door가 현재 세션 쿠키만을 지원하고 있으므로, 쿠키 수명은 사용자의 세션과 동일합니다. 

> [!NOTE]
> 공용 프록시는 세션 선호도를 방해할 수 있습니다. 이는 세션을 구축하려면 Front Door가 세션 선호도 쿠키를 응답에 추가해야 하기 때문입니다. 즉, 동일한 리소스를 요청하는 다른 클라이언트의 쿠키를 방해하므로 응답이 캐싱 가능한 경우 실행할 수 없습니다. 이로부터 보호하기 위해 시도될 때 백 엔드가 캐싱 가능한 응답을 전송하면 세션 선호도는 설정되지 **않습니다**. 세션이 이미 설정된 경우 백 엔드에서 응답을 캐싱할 수 있다면 문제가 되지 않습니다.
> 응답에 HTTP 304 상태 코드가 **없을 경우** 세션 선호도는 다음 상황에서 설정됩니다.
> - 응답에 캐싱을 방해하는 ```Cache-Control``` 헤더(예: "private" 또는 "no-store")에 대해 설정된 특정 값이 있습니다.
> - 응답에 만료되지 않은 ```Authorization``` 헤더가 있습니다.
> - 응답에 HTTP 302 상태 코드가 있습니다.

## <a name="next-steps"></a>다음 단계

- [Front Door를 만드는 방법](quickstart-create-front-door.md)을 알아봅니다.
- [Front Door의 작동 원리](front-door-routing-architecture.md)를 알아봅니다.
